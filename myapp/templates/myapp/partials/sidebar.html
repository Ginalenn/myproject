{% load static %}
<nav class="sidebar d-flex flex-column" id="side_nav">
  
  <!-- 1. SIDEBAR HEADER -->
  <div class="sidebar-header d-flex align-items-center">
    <img src="{% static 'myapp/images/wesmaarrdec.png' %}" alt="Logo" class="logo-img me-3">
    <span class="logo-text">WESMAARDEC</span>
  </div>

  <!-- 2. NAVIGATION LINKS -->
  <ul class="nav flex-column sidebar-nav flex-grow-1">

    <li class="nav-item-header">Main</li>

    <li class="nav-item">
      <a class="nav-link {% if request.resolver_match.url_name == 'manage_dashboard' %}active{% endif %}" 
         href="{% url 'myapp:manage_dashboard' %}"
         data-bs-toggle="tooltip" data-bs-placement="right" title="Dashboard">
        <i class="fa-solid fa-chart-pie fa-fw"></i>
        <span class="link-text">Dashboard</span>
      </a>
    </li>

    <li class="nav-item">
      <a class="nav-link {% if 'records' in request.resolver_match.url_name %}active{% endif %}" 
         href="{% url 'myapp:manage_records' %}"
         data-bs-toggle="tooltip" data-bs-placement="right" title="Manage Records">
        <i class="fa-solid fa-folder-open fa-fw"></i>
        <span class="link-text">Manage Records</span>
      </a>
    </li>

    <li class="nav-item-header">Tools</li>

    <li class="nav-item">
      <a class="nav-link {% if 'add_activity' in request.resolver_match.url_name %}active{% endif %}" 
         href="{% url 'myapp:add_activity_form' %}"
         data-bs-toggle="tooltip" data-bs-placement="right" title="Add New Record">
        <i class="fa-solid fa-file-pen fa-fw"></i>
        <span class="link-text">Add New Record</span>
      </a>
    </li>
    
    <li class="nav-item">
      <a class="nav-link" data-bs-toggle="collapse" href="#submenuReports" role="button" aria-expanded="false" aria-controls="submenuReports"
         data-bs-toggle-tooltip="tooltip" data-bs-placement="right" title="Reports">
        <i class="fa-solid fa-chart-simple fa-fw"></i>
        <span class="link-text">Reports</span>
        <i class="fa-solid fa-chevron-down small ms-auto"></i>
      </a>
      <div class="collapse" id="submenuReports">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a href="#" class="nav-link {% if request.resolver_match.url_name == 'monthly_report' %}active{% endif %}">Monthly</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">Annual</a>
          </li>
        </ul>
      </div>
    </li>
  </ul>

  <!-- 3. USER SECTION DROPDOWN (at the bottom) -->
  <div class="user-section dropdown">
    <hr class="text-white-50 m-0 mb-3">
    <a href="#" class="dropdown-toggle text-decoration-none" data-bs-toggle="dropdown" aria-expanded="false">
      <!-- Use a generic user icon, or even better, user.profile.avatar if you have one -->
      <img src="https://i.pravatar.cc/40?u={{ request.user.username }}" alt="User Avatar" class="user-avatar">
      <div class="user-info">
        <div class="username">{{ request.user.first_name|default:request.user.username }}</div>
        <div class="role text-muted">{% if user.is_superuser %}Admin{% else %}User{% endif %}</div>
      </div>
    </a>
    <ul class="dropdown-menu dropdown-menu-dark">
      <li><a class="dropdown-item" href="#"><i class="fa-solid fa-user-gear fa-fw me-2"></i>Profile</a></li>
      <li><a class="dropdown-item" href="#"><i class="fa-solid fa-sliders fa-fw me-2"></i>Settings</a></li>
      <li><hr class="dropdown-divider"></li>
      <li><a class="dropdown-item" href="{% url 'myapp:logout' %}"><i class="fa-solid fa-right-from-bracket fa-fw me-2"></i>Logout</a></li>
    </ul>
  </div>

</nav>